import java.text.ParseException;
import java.util.Arrays;
import java.util.stream.Collectors;

/**
 * @author liutao
 * @date Created in 2020/10/14 16:55
 * @description
 */
public class Test {
    public static void main(String[] args) throws ParseException {
        String string = "java.lang.reflect.InvocationTargetExceptionat sun.reflect.GeneratedMethodAccessor5301.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nccloud.pub.hrkq.util.AttendInvoker.beanInvoke(AttendInvoker.java:130)at nccloud.nc.impl.hrkq.common.AfterApproveAction.doAfterMethod(AfterApproveAction.java:45)at nccloud.nc.impl.hrkq.common.AfterApproveAction.doApprove(AfterApproveAction.java:200)at sun.reflect.GeneratedMethodAccessor6576.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.pub.pf.PfUtilTools.runClass(PfUtilTools.java:1211)at nc.bs.pub.compiler.AbstractCompiler.runClass(AbstractCompiler.java:508)at nc.bs.pub.action.N_6QBK_APPROVE.runComClass(N_6QBK_APPROVE.java:42)at nc.bs.pub.pf.pfframe.PFRunClass.runComBusi(PFRunClass.java:138)at nc.bs.pub.pf.pfframe.PFBusiAction.actionOnStep(PFBusiAction.java:419)at nc.bs.pub.pf.pfframe.PFBusiAction.processAction(PFBusiAction.java:1075)at sun.reflect.GeneratedMethodAccessor3963.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint$3.invoke(MethodProceedingJoinpoint.java:74)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:184)at nc.bs.framework.aop.rt.AdviceHolder.invoke(AdviceHolder.java:188)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:129)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:135)at nc.bs.framework.aop.rt.AspectedProxy.invoke(AspectedProxy.java:60)at com.sun.proxy.$Proxy656.processAction(Unknown Source)at sun.reflect.GeneratedMethodAccessor3963.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.ejb.CMTProxyImpl.delegate(CMTProxyImpl.java:22)at nc.itf.framework.ejb.CMTProxyEjbBean.delegate(CMTProxyEjbBean.java:44)at nc.itf.framework.ejb.CMTProxy_Local.delegate(CMTProxy_Local.java:75)at sun.reflect.GeneratedMethodAccessor117.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.ejb.AbstractEJBServiceHandler.invoke(AbstractEJBServiceHandler.java:57)at nc.bs.framework.ejb.AbstractEJBServiceHandler.invoke(AbstractEJBServiceHandler.java:36)at com.sun.proxy.$Proxy31.delegate(Unknown Source)at nc.bs.framework.ejb.CMTEJBServiceHandler.invoke(CMTEJBServiceHandler.java:32)at com.sun.proxy.$Proxy657.processAction(Unknown Source)at nc.bs.pub.pf.pfframe.PlatFormEntryImpl.processAction(PlatFormEntryImpl.java:196)at sun.reflect.GeneratedMethodAccessor3962.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint$3.invoke(MethodProceedingJoinpoint.java:74)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:184)at nc.bs.framework.server.SecurityAspect.aroundMethod1(SecurityAspect.java:69)at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.aop.rt.AdviceHolder.invoke(AdviceHolder.java:182)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:129)at nc.bs.framework.aop.rt.MethodProceedingJoinpoint.proceed(MethodProceedingJoinpoint.java:135)at nc.bs.framework.aop.rt.AspectedProxy.invoke(AspectedProxy.java:60)at com.sun.proxy.$Proxy654.processAction(Unknown Source)at sun.reflect.GeneratedMethodAccessor3962.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.ejb.CMTProxyImpl.delegate(CMTProxyImpl.java:22)at nc.itf.framework.ejb.CMTProxyEjbBean.delegate(CMTProxyEjbBean.java:44)at nc.itf.framework.ejb.CMTProxy_Local.delegate(CMTProxy_Local.java:75)at sun.reflect.GeneratedMethodAccessor117.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nc.bs.framework.ejb.AbstractEJBServiceHandler.invoke(AbstractEJBServiceHandler.java:57)at nc.bs.framework.ejb.AbstractEJBServiceHandler.invoke(AbstractEJBServiceHandler.java:36)at com.sun.proxy.$Proxy31.delegate(Unknown Source)at nc.bs.framework.ejb.CMTEJBServiceHandler.invoke(CMTEJBServiceHandler.java:32)at com.sun.proxy.$Proxy655.processAction(Unknown Source)at sun.reflect.GeneratedMethodAccessor3962.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at nccloud.framework.service.ServiceHandler.invoke(ServiceHandler.java:54)at com.sun.proxy.$Proxy655.processAction(Unknown Source)at nccloud.web.workflow.approvalcenter.action.ApproveOrSignalActionUtil.processAction(ApproveOrSignalActionUtil.java:53)at nccloud.web.workflow.approvalcenter.action.ApprovePassAction.doAction(ApprovePassAction.java:414)at nccloud.framework.web.action.excutor.CommonActionExcutor.excute(CommonActionExcutor.java:18)at nccloud.framework.web.action.entry.ActionExcutor.excute(ActionExcutor.java:93)at nccloud.framework.web.action.entry.Dispatcher.excute(Dispatcher.java:84)at nccloud.framework.web.action.entry.Dispatcher.doAction(Dispatcher.java:41)at nccloud.framework.web.action.entry.EntryController.doPost(EntryController.java:37)Caused by: org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.TooManyResultsException: Expected one result (or null) to be returned by selectOne(), but found: 2at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:77)at com.yonyou.hrcloud.adder.ext.spring.MybatisSqlTemplate$SqlSessionInterceptor.invoke(MybatisSqlTemplate.java:490)at com.sun.proxy.$Proxy216.selectOne(Unknown Source)at com.yonyou.hrcloud.adder.ext.spring.MybatisSqlTemplate.selectOne(MybatisSqlTemplate.java:155)at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:82)at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59)at com.sun.proxy.$Proxy269.loadByInstanceId(Unknown Source)at com.yonyou.hrcloud.sign.impl.FillAttendHeadServiceImpl.loadByInstanceId(FillAttendHeadServiceImpl.java:80)at sun.reflect.GeneratedMethodAccessor5319.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)at com.sun.proxy.$Proxy270.loadByInstanceId(Unknown Source)at com.yonyou.hrcloud.bill.impl.NCCBillServiceImpl.getFillAttendHeadBill(NCCBillServiceImpl.java:416)at com.yonyou.hrcloud.bill.impl.NCCBillServiceImpl.handleCalbackPending(NCCBillServiceImpl.java:203)at com.yonyou.hrcloud.bill.impl.NCCBillServiceImpl.callback(NCCBillServiceImpl.java:95)... 80 moreCaused by: org.apache.ibatis.exceptions.TooManyResultsException: Expected one result (or null) to be returned by selectOne(), but found: 2at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:81)at sun.reflect.GeneratedMethodAccessor478.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)at java.lang.reflect.Method.invoke(Method.java:508)at com.yonyou.hrcloud.adder.ext.spring.MybatisSqlTemplate$SqlSessionInterceptor.invoke(MybatisSqlTemplate.java:470)... 101 more";

        String collect = Arrays.stream(string.split("at "))
                .filter(str -> !str.startsWith("org.") && !str.startsWith("java"))
                .filter(str -> !str.startsWith("nc.itf.framework."))
                .filter(str -> !str.startsWith("nc.bs.framework.") && !str.startsWith("nccloud.framework."))
                .collect(Collectors.joining("\n at "));
        System.out.println(collect);


        String sql = "SELECT " +
                "o.pk_org AS pk_org, " +
                "FROM " +
                "org_orgs o " +
                "INNER JOIN org_adminorg a ON o.pk_org = a.pk_adminorg " +
                "WHERE " +
                "a.enablestate = 2 " +
                "AND a.islastversion = 'Y' " +
                "AND a.dr = 0 " +
                "AND ";

        System.out.println(sql);

    }

}
